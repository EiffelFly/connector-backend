{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/instill-ai/connector-backend/blob/main/configs/models/connector.json",
  "title": "Connector",
  "description": "Standard data connector",
  "type": "object",
  "additionalProperties": false,
  "required": ["configuration"],
  "anyOf": [
    {"required": ["user"], "not": {"required": ["org"]}},
    {"required": ["org"], "not": {"required": ["user"]}},
    {"not": {"required": ["user", "org"]}}
  ],
  "properties": {
    "description": {
      "type": "string",
      "title": "Description",
      "description": "Fill with a short description of the connector",
      "minLength": 0,
      "maxLength": 1023,
      "ui_order": 0,
      "ui_component": "textarea_enable_counter"
    },
    "configuration": {
      "type": "string",
      "title": "Configuration",
      "description": "Connector configuration JSON string that has been validated using the JSON schema of the corresponding `Spec.connection_specification`.",
      "ui_order": 1,
      "ui_disabled": true
    },
    "tombstone": {
      "type": "boolean",
      "title": "Tombstone",
      "description": "If not set or false, the configuration is active. if true, then this configuration is permanently off.",
      "default": false,
      "readOnly": true,
      "ui_order": 2,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "toggle"
    },
    "user": {
      "type": "string",
      "description": "The resource name of a user",
      "readOnly": true,
      "ui_order": 3,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "text"
    },
    "org": {
      "type": "string",
      "description": "The resource name of an organization",
      "readOnly": true,
      "ui_order": 3,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "text"
    },
    "create_time": {
      "type": "string",
      "format": "date-time",
      "title": "Create time",
      "description": "The date when the connector definiton is created in the format YYYY-MM-DDTHH:MM::SS",
      "examples": ["2022-04-29T00:20:06.703547Z"],
      "readOnly": true,
      "ui_order": 4,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "text"
    },
    "update_time": {
      "type": "string",
      "format": "date-time",
      "title": "Update time",
      "description": "The date when the connector definition is updated in the format YYYY-MM-DDTHH:MM::SS",
      "examples": ["2022-04-29T01:33:34.910865Z"],
      "readOnly": true,
      "ui_order": 5,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "text"
    }
  },
  "definitions": {
    "SourceConnector": {
      "title": "SourceConnector",
      "description": "Standard data source",
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "source_connector_definition", "connector"],
      "properties": {
        "name": {
          "type": "string",
          "title": "Resource name",
          "description": "The resource name",
          "readOnly": true,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "uid": {
          "type": "string",
          "format": "uuid",
          "title": "UUID",
          "description": "The unique UUID",
          "readOnly": true,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "id": {
          "type": "string",
          "title": "Name",
          "description": "The source connector name",
          "pattern": "^[a-z]([a-z0-9-]{0,61}[a-z0-9])?$",
          "minLength": 1,
          "maxLength": 63,
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "source_connector_definition": {
          "type": "string",
          "title": "Source definition resource name",
          "description": "The resource name of the source definition",
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "connector": {
          "type": "object",
          "title": "Definition",
          "description": "Source connector",
          "ref": "#/definitions/Connector",
          "additionalProperties": false,
          "ui_order": 4
        }
      }
    },
    "SourceDefinition": {
      "title": "SourceDefinition",
      "description": "The standard source definition",
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "connector_definition"],
      "properties": {
        "name": {
          "type": "string",
          "title": "Resource name",
          "description": "The resource name",
          "readOnly": true,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "uid": {
          "type": "string",
          "format": "uuid",
          "title": "UUID",
          "description": "The unique UUID",
          "readOnly": true,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "id": {
          "type": "string",
          "title": "Name",
          "description": "The source definition name",
          "pattern": "^[a-z]([a-z0-9-]{0,61}[a-z0-9])?$",
          "minLength": 1,
          "maxLength": 63,
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "connector_definition": {
          "type": "object",
          "title": "Definition",
          "description": "Source connector definition",
          "ref": "#/definitions/ConnectorDefinition",
          "additionalProperties": false,
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true
        }
      }
    },
    "DestinationDefinition": {
      "title": "DestinationDefinition",
      "description": "The standard destination definition",
      "type": "object",
      "additionalProperties": false,
      "required": ["id", "connector_definition"],
      "properties": {
        "name": {
          "type": "string",
          "title": "Resource name",
          "description": "The resource name",
          "readOnly": true,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "uid": {
          "type": "string",
          "format": "uuid",
          "title": "UUID",
          "description": "The unique UUID",
          "readOnly": true,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "id": {
          "type": "string",
          "title": "Name",
          "description": "The destination definition name",
          "pattern": "^[a-z]([a-z0-9-]{0,61}[a-z0-9])?$",
          "minLength": 1,
          "maxLength": 63,
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "connector_definition": {
          "type": "object",
          "title": "Definition",
          "description": "Destination connector definition",
          "ref": "#/definitions/ConnectorDefinition",
          "additionalProperties": false,
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true
        }
      }
    },
    "ConnectorDefinition": {
      "type": "object",
      "title": "ConnectorDefinition",
      "description": "The connector definition data structure",
      "required": [
        "title",
        "documentation_url",
        "icon",
        "connection_type",
        "spec",
        "tombstone",
        "public",
        "custom",
        "release_stage"
      ],
      "properties": {
        "title": {
          "type": "string",
          "title": "Model definition",
          "description": "The source definition, e.g. HTTP",
          "minLength": 1,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "docker_repository": {
          "type": "string",
          "title": "Docker repository",
          "description": "The docker repository of the connector",
          "minLength": 0,
          "maxLength": 256,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "docker_image_tag": {
          "type": "string",
          "title": "Docker image tag",
          "description": "The docker image tag of the connector",
          "minLength": 0,
          "maxLength": 256,
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "documentation_url": {
          "type": "string",
          "format": "uri",
          "title": "Setup guide",
          "description": "Please check the setup guide for this connector definition",
          "minLength": 1,
          "maxLength": 1024,
          "readOnly": true,
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "icon": {
          "type": "string",
          "format": "uri-reference",
          "title": "Model definition icon",
          "description": "Icon for this connector definition",
          "minLength": 1,
          "maxLength": 256,
          "readOnly": true,
          "ui_order": 4,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "connection_type": {
          "type": "string",
          "title": "Connection type",
          "description": "The connection type of the connector",
          "enum": [
            "CONNECTION_TYPE_UNSPECIFIED",
            "CONNECTION_TYPE_DIRECTNESS",
            "CONNECTION_TYPE_API",
            "CONNECTION_TYPE_FILE",
            "CONNECTION_TYPE_DATABASE",
            "CONNECTION_TYPE_CUSTOM"
          ],
          "default": "CONNECTION_TYPE_UNSPECIFIED",
          "readOnly": true,
          "ui_order": 5,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "select",
          "ui_enum": ["", "Directness", "API", "File", "Database", "Custom"]
        },
        "spec": {
          "type": "object",
          "ref": "#/definitions/Spec",
          "readOnly": true,
          "ui_order": 6
        },
        "tombstone": {
          "type": "boolean",
          "title": "Tombstone",
          "description": "If not set or false, the configuration is active. if true, then this configuration is permanently off.",
          "default": false,
          "readOnly": true,
          "ui_order": 7,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "public": {
          "type": "boolean",
          "title": "Public",
          "description": "True if this connector definition is available to all users",
          "default": true,
          "readOnly": true,
          "ui_order": 8,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "custom": {
          "type": "boolean",
          "title": "Custom",
          "description": "Whether this is a custom connector definition",
          "default": false,
          "readOnly": true,
          "ui_order": 9,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "release_stage": {
          "type": "string",
          "title": "Release stage",
          "description": "The release stage of the connector",
          "enum": [
            "RELEASE_STAGE_UNSPECIFIED",
            "RELEASE_STAGE_ALPHA",
            "RELEASE_STAGE_BETA",
            "RELEASE_STAGE_GENERALLY_AVAILABLE",
            "RELEASE_STAGE_CUSTOM"
          ],
          "default": "RELEASE_STAGE_UNSPECIFIED",
          "readOnly": true,
          "ui_order": 10,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "select",
          "ui_enum": ["", "Alpha", "Beta", "Generally available", "Custom"]
        },
        "release_data": {
          "type": "string",
          "format": "date",
          "title": "Release date",
          "description": "The date when this connector was first released, in yyyy-mm-dd format.",
          "readOnly": true,
          "ui_order": 11,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "resource_requirements": {
          "type": "object",
          "title": "Resource requirements",
          "description": "Resource requirements blob. Must be a valid JSON that includes what resources are needed for the connector",
          "additionalProperties": false,
          "ui_order": 12,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "create_time": {
          "type": "string",
          "format": "date-time",
          "title": "Create time",
          "description": "The date when the connector definiton is created in the format YYYY-MM-DDTHH:MM::SS",
          "examples": ["2022-04-29T00:20:06.703547Z"],
          "readOnly": true,
          "ui_order": 13,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "update_time": {
          "type": "string",
          "format": "date-time",
          "title": "Update time",
          "description": "The date when the connector definition is updated in the format YYYY-MM-DDTHH:MM::SS",
          "examples": ["2022-04-29T01:33:34.910865Z"],
          "readOnly": true,
          "ui_order": 14,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        }
      }
    },
    "Spec": {
      "type": "object",
      "title": "ConnectorDefinition specification",
      "description": "Specification of a connector definition (source/destination)",
      "required": ["documentation_url", "connection_specification"],
      "additionalProperties": false,
      "properties": {
        "documentation_url": {
          "type": "string",
          "format": "uri",
          "title": "Setup guide",
          "description": "Please check the setup guide for this connector definition",
          "minLength": 1,
          "maxLength": 1024,
          "readOnly": true,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "changelog_url": {
          "type": "string",
          "format": "uri",
          "title": "Changelog URL",
          "description": "The Changelog URL of the connector",
          "minLength": 0,
          "maxLength": 1024,
          "readOnly": true,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "text"
        },
        "connection_specification": {
          "type": "object",
          "title": "Connection specification",
          "description": "This is a JSON Schema used to validate JSON configuration of a connector. Must be a valid JSON the includes all the fields needs to be configured for this connector.",
          "instill_order": 3
        },
        "supports_incremental": {
          "type": "boolean",
          "title": "Support incremental",
          "description": "If the connector supports incremental mode or not.",
          "default": false,
          "readOnly": true,
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "supports_normalization": {
          "type": "boolean",
          "title": "Support normalization",
          "description": "If the connector supports normalization or not.",
          "default": false,
          "readOnly": true,
          "ui_order": 4,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "supports_dbt": {
          "type": "boolean",
          "title": "Support DBT",
          "description": "If the connector supports DBT or not.",
          "default": false,
          "readOnly": true,
          "ui_order": 5,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "toggle"
        },
        "supported_destination_sync_modes": {
          "type": "array",
          "title": "Support destination sync modes",
          "description": "List of destination sync modes supported by the connector",
          "items": {
            "$ref": "#/definitions/DestinationSyncMode"
          },
          "readOnly": true,
          "ui_order": 6
        },
        "advanced_auth": {
          "ref": "#/definitions/AdvancedAuth",
          "ui_order": 7,
          "ui_disabled": true
        }
      }
    },
    "DestinationSyncMode": {
      "type": "string",
      "title": "Destination sync mode",
      "description": "Destination sync mode/",
      "enum": [
        "SUPPORTED_DESTINATION_SYNC_MODES_UNSPECIFIED",
        "SUPPORTED_DESTINATION_SYNC_MODES_APPEND",
        "SUPPORTED_DESTINATION_SYNC_MODES_OVERWRITE",
        "SUPPORTED_DESTINATION_SYNC_MODES_APPEND_DEDUP"
      ],
      "readOnly": true,
      "ui_order": 0,
      "ui_hidden": true,
      "ui_disabled": true,
      "ui_component": "select",
      "ui_enum": ["", "Append", "Overwrite", "Append dedup"]
    },
    "AdvancedAuth": {
      "type": "object",
      "title": "Advanced auth flow",
      "description": "Additional and optional specification object to describe what an 'advanced' Auth flow would need to function.",
      "required": [],
      "properties": {
        "auth_flow_type": {
          "type": "string",
          "title": "Auth flow type",
          "description": "The supported auth flow types",
          "enum": [
            "AUTH_FLOW_TYPE_UNSPECIFIED",
            "AUTH_FLOW_TYPE_OAUTH2_0",
            "AUTH_FLOW_TYPE_OAUTH1_0"
          ],
          "readOnly": true,
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true,
          "ui_component": "select",
          "ui_enum": ["", "OAuth2.0", "0Auth1.0"]
        },
        "predicate_key": {
          "type": "array",
          "title": "Predicate key",
          "description": "JSON Path to a field in the connectorSpecification that should exist for the advanced auth to be applicable.",
          "items": {
            "type": "string"
          },
          "readOnly": true,
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "predicate_value": {
          "type": "string",
          "title": "Predicate value",
          "description": "Value of the predicate_key fields for the advanced auth to be applicable.",
          "readOnly": true,
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "oauth_config_specification": {
          "$ref": "#/definitions/OAuthConfigSpecification",
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true
        }
      }
    },
    "OAuthConfigSpecification": {
      "type": "object",
      "title": "OAuth configuration specification",
      "required": [],
      "properties": {
        "oauth_user_input_from_connector_config_specification": {
          "type": "object",
          "description": "OAuth specific blob. This is a JSON Schema used to validate JSON configurations used as input to OAuth Must be a valid non-nested JSON that refers to properties from Spec.connection_specification using special annotation 'path_in_connector_config'. These are input values the user is entering through the UI to authenticate to the connector, that might also shared as inputs for syncing data via the connector.",
          "ui_order": 0,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "complete_oauth_output_specification": {
          "type": "object",
          "description": "OAuth specific blob. This is a JSON Schema used to validate JSON configurations produced by the OAuth flows as they are returned by the distant OAuth APIs. Must be a valid JSON describing the fields to merge back to `Spec.connection_specification`. For each field, a special annotation `path_in_connector_config` can be specified to determine where to merge it,",
          "ui_order": 1,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "complete_oauth_server_input_specification": {
          "type": "object",
          "description": "OAuth specific blob. This is a JSON Schema used to validate JSON configurations persisted as Server configurations. Must be a valid non-nested JSON describing additional fields configured to be used by the server when completing an OAuth flow (typically exchanging an auth code for refresh token).",
          "ui_order": 2,
          "ui_hidden": true,
          "ui_disabled": true
        },
        "complete_oauth_server_output_specification": {
          "type": "object",
          "description": "OAuth specific blob. This is a JSON Schema used to validate JSON configurations persisted as Server configurations that also need to be merged back into the connector configuration at runtime. This is a subset configuration of `complete_oauth_server_input_specification` that filters fields out to retain only the ones that are necessary for the connector to function with OAuth. (some fields could be used during oauth flows but not needed afterwards, therefore they would be listed in the `complete_oauth_server_input_specification` but not `complete_oauth_server_output_specification`). Must be a valid non-nested JSON describing additional fields configured to be used by the connector when using OAuth flow APIs. These fields are to be merged back to `Spec.connection_specification`.",
          "ui_order": 3,
          "ui_hidden": true,
          "ui_disabled": true
        }
      }
    }
  }
}
